!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Wokfront={})}(this,(function(t){"use strict";var e=function(){return(e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},n=function(){function t(t){var e,n;this.serverAcceptsJSON=!0,this._uriGenerationMode=!1,this._httpOptions={url:t.url,alwaysUseGet:t.alwaysUseGet,headers:t.headers||{}},t.apiKey&&(this._httpOptions.headers.apiKey=t.apiKey);var r=void 0===(e=t.version)?"internal":e;["internal","unsupported","asp"].indexOf(r)>=0?n="/attask/api-"+r:(n="/attask/api/v"+r,"2.0"!==r&&"3.0"!==r&&"4.0"!==r||(this.serverAcceptsJSON=!1)),this._httpOptions.path=n}return t.prototype.getApiKey=function(t,e,n){var r=this,o={username:t,password:e};return void 0!==n&&(o.subdomain=n),new Promise((function(t,e){void 0!==r._httpOptions.headers.apiKey?t(r._httpOptions.headers.apiKey):r.execute("USER",null,"getApiKey",o).then((function(n){""===n.result?r.execute("USER",null,"generateApiKey",o).then((function(e){r._httpOptions.headers.apiKey=e.result,t(r._httpOptions.headers.apiKey)}),e):(r._httpOptions.headers.apiKey=n.result,t(r._httpOptions.headers.apiKey))}),e)}))},t.prototype.copy=function(e,n,r,o,s){var i={copySourceID:n};return r&&(i.updates=JSON.stringify(r)),s&&(i.options=JSON.stringify(s)),this.request(e,i,o,t.Methods.POST)},t.prototype.count=function(e,n){var r=this.request(e+"/count",n,null,t.Methods.GET);return this._uriGenerationMode?r:r.then((function(t){return t.count}))},t.prototype.clearApiKey=function(){var t=this;return new Promise((function(e,n){t.execute("USER",null,"clearApiKey").then((function(r){r?(delete t._httpOptions.headers.apiKey,e()):n()}))}))},t.prototype.create=function(e,n,r){return n.hasOwnProperty("updates")?this.request(e,n,r,t.Methods.POST):this.request(e,{updates:n},r,t.Methods.POST)},t.prototype.edit=function(e,n,r,o){return r.hasOwnProperty("updates")?this.request(e+"/"+n,r,o,t.Methods.PUT):this.request(e+"/"+n,{updates:r},o,t.Methods.PUT)},t.prototype.editMultiple=function(e,n,r){return this.request(e,{updates:n},r,t.Methods.PUT)},t.prototype.execute=function(n,r,o,s){var i=n,u={method:t.Methods.PUT};return r?i+="/"+r+"/"+o:u.action=o,s&&(u=e(e({},u),s)),this.request(i,u,null,t.Methods.POST)},t.prototype.get=function(e,n,r){"string"==typeof n&&(n=[n]);var o=e,s=null;return 1===n.length?0===n[0].indexOf("$$")?s={id:n[0]}:o+="/"+n[0]:s={id:n},this.request(o,s,r,t.Methods.GET)},t.prototype.login=function(e,n,r){var o=this,s={username:e,password:n};return void 0!==r&&(s.subdomain=r),this.request("login",s,null,t.Methods.POST).then((function(t){return o.setSessionID(t.sessionID),t}))},t.prototype.logout=function(){var e=this;return new Promise((function(n,r){e.request("logout",null,null,t.Methods.GET).then((function(t){t&&t.success?(delete e._httpOptions.headers["X-XSRF-TOKEN"],delete e._httpOptions.headers.sessionID,n()):r()}))}))},t.prototype.metadata=function(e,n){var r="/metadata";return e&&(r=e+r),this.request(r,null,n,t.Methods.GET)},t.prototype.namedQuery=function(e,n,r,o){return this.request(e+"/"+n,r,o,t.Methods.GET)},t.prototype.remove=function(e,n,r){var o=r?{force:!0}:null,s=this.request(e+"/"+n,o,null,t.Methods.DELETE);return this._uriGenerationMode?s:new Promise((function(t,e){s.then((function(n){n&&n.success?t():e()}),e)}))},t.prototype.report=function(n,r,o){var s,i;return void 0===o&&(o=!1),o?(s=e(e({},r),{method:t.Methods.GET}),i=t.Methods.POST):(s=r,i=t.Methods.GET),this.request(n+"/report",s,null,i)},t.prototype.request=function(n,r,o,i){var u;void 0===o&&(o=[]),void 0===i&&(i=t.Methods.GET);var a=e({},r),p=this.getOptions(n,a,this._uriGenerationMode?t.Methods.GET:i),h=this.getFields(o);h&&(a.fields=h);var d=this.getHeaders(),c=(u=this.populateQueryStringAndBodyParams(a,p)).bodyParams,f=u.queryString,l=u.contentType;if(l&&d.append("Content-Type",l),this._uriGenerationMode){var y="";return-1===f.indexOf("method=")&&(y=(""===f?"?":"&")+"method="+t.Methods.GET),n+f+y}return s(p.url+p.path+f,{headers:d,body:c,method:p.method})},t.prototype.search=function(n,r,o,s){var i,u;return void 0===s&&(s=!1),s?(i=e(e({},r),{method:t.Methods.GET}),u=t.Methods.POST):(i=r,u=t.Methods.GET),this.request(n+"/search",i,o,u)},t.prototype.batch=function(e,n,r){var s=e(o(this));if(0===s.length)return Promise.resolve(n?void 0:[]);var i=this.request("/batch",{atomic:!!n,uri:s,concurrent:!!r},void 0,t.Methods.POST);return n?i.then((function(t){if(!t||!t.success)throw new Error})):i.then((function(t){return t.map((function(t){return t.data}))}))},t.prototype.setApiKey=function(t){return this._httpOptions.headers.apiKey=t},t.prototype.setSessionID=function(t){t?this._httpOptions.headers.sessionID=t:delete this._httpOptions.headers.sessionID},t.prototype.setXSRFToken=function(t){t?this._httpOptions.headers["X-XSRF-TOKEN"]=t:delete this._httpOptions.headers["X-XSRF-TOKEN"]},t.prototype.uploadFileContent=function(e,n){var r=new FormData;return r.append("uploadedFile",e,n),this.request("upload",r,null,t.Methods.POST)},t.prototype.getHeaders=function(){var t=new Headers;return t.append("X-Requested-With","XMLHttpRequest"),this._httpOptions.headers.sessionID?t.append("sessionID",this._httpOptions.headers.sessionID):this._httpOptions.headers["X-XSRF-TOKEN"]?t.append("X-XSRF-TOKEN",this._httpOptions.headers["X-XSRF-TOKEN"]):this._httpOptions.headers.apiKey&&t.append("apiKey",this._httpOptions.headers.apiKey),t},t.prototype.getFields=function(t){return"string"==typeof t?t:Array.isArray(t)?t.join(","):void 0},t.prototype.getOptions=function(n,r,o){var s=e({},this._httpOptions);return s.alwaysUseGet&&"login"!==n?(r.method=o,s.method=t.Methods.GET):s.method=o,0!==n.indexOf("/")&&(n="/"+n),s.path=this._httpOptions.path+n,s},t.prototype.populateQueryStringAndBodyParams=function(e,n){var o=null,s="",i=null;if("undefined"!=typeof FormData&&e instanceof FormData)o=e;else if(!this.serverAcceptsJSON||"object"!=typeof e.updates||n.method!==t.Methods.POST&&n.method!==t.Methods.PUT)i="application/x-www-form-urlencoded",e.hasOwnProperty("updates")&&"string"!=typeof e.updates&&(e.updates=JSON.stringify(e.updates)),o=r(e),n.method!==t.Methods.GET&&n.method!==t.Methods.DELETE||(o&&(s="?"+o),o=null);else{i="application/json",o=JSON.stringify(e.updates),delete e.updates;var u=r(e);u&&(s="?"+u)}return{bodyParams:o,queryString:s,contentType:i}},t.Methods={GET:"GET",PUT:"PUT",DELETE:"DELETE",POST:"POST"},t}(),r=function(t){return Object.keys(t).reduce((function(e,n){return Array.isArray(t[n])?t[n].forEach((function(t){e.push(n+"="+encodeURIComponent(t))})):e.push(n+"="+encodeURIComponent(t[n])),e}),[]).join("&")};function o(t){var e=Object.create(t);return e._uriGenerationMode=!0,{copy:function(t,n,r,o,s){return e.copy(t,n,r,o,s)},count:function(t,n){return e.count(t,n)},create:function(t,n,r){return e.create(t,n,r)},edit:function(t,n,r,o){return e.edit(t,n,r,o)},editMultiple:function(t,n,r){return e.editMultiple(t,n,r)},execute:function(t,n,r,o){return e.execute(t,n,r,o)},get:function(t,n,r){return e.get(t,n,r)},metadata:function(t,n){return e.metadata(t,n)},namedQuery:function(t,n,r,o){return e.namedQuery(t,n,r,o)},remove:function(t,n,r){return e.remove(t,n,r)},report:function(t,n){return e.report(t,n)},request:function(t,r,o,s){return void 0===s&&(s=n.Methods.GET),e.request(t,r,o,s)},search:function(t,n,r){return e.search(t,n,r,!1)}}}function s(t,n){return fetch(t,e(e({},n),{credentials:"same-origin"})).then(i.success,i.failure)}var i={success:function(t){return t.ok?t.json().then((function(e){if(e.error)throw{status:t.status,message:e.error.message};return e.data})):t.json().then((function(e){throw{status:t.status,message:e.error.message}}),(function(){throw{status:t.status,message:t.statusText}}))},failure:function(t){throw{message:t.message||t.statusText}}};t.Api=n,t.ResponseHandler=i,t.makeFetchCall=s}));
//# sourceMappingURL=workfront-api.umd.min.js.map
